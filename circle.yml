machine:
  environment:
    PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin"
  timezone:
    Asia/Tokyo
  node:
    version: 9.2.0

dependencies:
  override:
    - sudo pip install awscli
  post:
    - aws configure set region ap-northeast-1

test:
  override:
    - echo "Run test script here."
    - make clean-node-modules clean-dist
    - make node-modules
    - make build

deployment:
  all:
    branch: release
    commands:
      - make clean-node-modules clean-dist
      - make node-modules
      - make release-build
      - aws s3 sync dist/ s3://app.tanb/ --delete --cache-control "no-cache"
